package me.newpredator.Annihilation.chat;

import me.newpredator.Annihilation.Annihilation;
import me.newpredator.Annihilation.api.TitleApi;
import me.newpredator.Annihilation.manager.PhaseManager;
import me.newpredator.Annihilation.object.Boss;
import me.newpredator.Annihilation.object.GameTeam;
import me.newpredator.Annihilation.object.Kit;
import me.newpredator.Annihilation.object.PlayerMeta;

import org.bukkit.Bukkit;
import org.bukkit.ChatColor;
import org.bukkit.entity.Player;

import ru.tehkode.permissions.PermissionUser;
import ru.tehkode.permissions.bukkit.PermissionsEx;

public class ChatUtil {

    private static final String DARK_GRAY = ChatColor.DARK_GRAY.toString();
    private static final String DARK_PURPLE = ChatColor.DARK_PURPLE.toString();
    private static final String DARK_RED = ChatColor.DARK_RED.toString();
    private static final String GRAY = ChatColor.GRAY.toString();
    private static final String RED = ChatColor.RED.toString();
	private static final String GOLD = ChatColor.GOLD.toString();
	private static final String WHITE = ChatColor.WHITE.toString();
    private static final String AQUA = ChatColor.AQUA.toString();
    private static final String BOLD = ChatColor.BOLD.toString();
	private final Annihilation plugin;

    public ChatUtil(Annihilation pl) {
        plugin = pl;
        plugin.configManager.getConfig("config.yml");
    }

    public static void setRoman(boolean b) {
    }

    public static void allMessage(GameTeam team, Player sender, String message,
            boolean dead) {

        String group = null;
        String username;
        
        PermissionUser user = PermissionsEx.getUser(sender.getName());
        String rank = user.getPrefix();
        if (!rank.equals(""))
        group += " " + rank.replaceAll("&", "§");
        
        if (team == GameTeam.NONE) {
            group = GRAY + "(All) " + GRAY + "[" + DARK_PURPLE + "Annihilation" + GRAY + "]" + rank.replaceAll("&", "§");
            username = sender.getName();
        } else {
            group = GRAY + "(All) " + GRAY + "[" + team.coloredName() + GRAY + "]" + rank.replaceAll("&", "§");
            username = sender.getName();
            if (dead) {
                group = DARK_GRAY + "[" + DARK_RED + "MUERTO" + DARK_GRAY + " "
                        + group + rank.replaceAll("&", "§");
            }
        }
        String msg = message;
        
        String toSend = group + " §r" + username + DARK_GRAY + ": " + WHITE + msg;
        for (Player player : Bukkit.getOnlinePlayers())
            player.sendMessage(toSend);
    }

    public static void teamMessage(GameTeam team, Player sender,
            String message, boolean dead) {
        String group;
        if (team == GameTeam.NONE) {
            allMessage(team, sender, message, false);
            return;
        } else {
            group = GRAY + "(Equipo) " + GRAY + "[" + team.coloredName() + GRAY + "]";
            if (dead) {
                group = DARK_GRAY + "[" + DARK_RED + "MUERTO" + DARK_GRAY + "]" + group;
            }
        }
        PermissionUser user = PermissionsEx.getUser(sender.getName());
        String rank = user.getPrefix();
        if (!rank.equals(""))
            group += " " + rank.replaceAll("&", "§");
        String toSend = group + " §r" + sender.getName() + ChatColor.DARK_GRAY + ": " + ChatColor.GOLD + message;
        for (Player player : team.getPlayers())
            player.sendMessage(toSend);
    }

	public static void broadcast(String message) {
        Bukkit.broadcastMessage(ChatColor.translateAlternateColorCodes('&',
                message));
    }

    public static void nexusDestroyed(GameTeam attacker, GameTeam victim,
            Player p) {
            broadcast(GRAY + "вввввввввввввввввввв");
            broadcast(GRAY + "вввв" + victim.color().toString() + "вввввввввв" + GRAY + "вввввв");
            broadcast(GRAY + "вввв" + victim.color().toString() + "вв" + GRAY + "вввввввв" + victim.color().toString() + "вв" + GRAY + "вввв");
            broadcast(GRAY + "вввв" + victim.color().toString() + "вв" + GRAY + "вввввввв" + victim.color().toString() + "вв" + GRAY + "вввв");
            broadcast(GRAY + "вввв" + victim.color().toString() + "вв" + GRAY + "вввввввв" + victim.color().toString() + "вв" + GRAY + "вввв El nexus " + victim.coloredName() + DARK_GRAY + " ћ" + RED + "" + BOLD + " FUE ELIMINADO");
            broadcast(GRAY + "вввв" + victim.color().toString() + "вв" + GRAY + "вввввввв" + victim.color().toString() + "вв" + GRAY + "вввв por " + attacker.color().toString() + p.getName());
            broadcast(GRAY + "вввв" + victim.color().toString() + "вв" + GRAY + "вввввввв" + victim.color().toString() + "вв" + GRAY + "вввв");
            broadcast(GRAY + "вввв" + victim.color().toString() + "вв" + GRAY + "вввввввв" + victim.color().toString() + "вв" + GRAY + "вввв");
            broadcast(GRAY + "вввв" + victim.color().toString() + "вввввввввв" + GRAY + "вввввв");
            broadcast(GRAY + "вввввввввввввввввввв");
    }

    public static String nexusBreakMessage(Player breaker, GameTeam attacker,
            GameTeam victim) {
        return colorizeName(breaker, attacker) + GRAY + " ha daсado el "
                + victim.coloredName() + " team's Nexus!";
    }

    private static String colorizeName(Player player, GameTeam team) {
        return team.color() + player.getName();
    }

    @SuppressWarnings("static-access")
	public static void phaseMessage(int phase) {
        switch (phase) {
            case 1:
                
            broadcast(GRAY + "вввввввввввввввввввв");
            broadcast(GRAY + "вввввввв" + RED + "вввв" + GRAY + "вввввввв");
            broadcast(GRAY + "вввв" + RED + "вввввввв" + GRAY + "вввввввв");
            broadcast(GRAY + "вввввввв" + RED + "вввв" + GRAY + "вввввввв");
            broadcast(GRAY + "вввввввв" + RED + "вввв" + GRAY + "вввввввв El juego ha" + GOLD + " empezado!");
            broadcast(GRAY + "вввввввв" + RED + "вввв" + GRAY + "вввввввв El nexus es" + GOLD + " invencible");
            broadcast(GRAY + "вввввввв" + RED + "вввв" + GRAY + "вввввввв");
            broadcast(GRAY + "вввввввв" + RED + "вввв" + GRAY + "вввввввв");
            broadcast(GRAY + "вввв" + RED + "вввввввввввв" + GRAY + "вввв");
            broadcast(GRAY + "вввввввввввввввввввв");
            break;
            case 2:
            broadcast(GRAY + "вввввввввввввввввввв");
            broadcast(GRAY + "вввввв" + RED + "вввввввв" + GRAY + "вввввв");
            broadcast(GRAY + "вввв" + RED + "вв" + GRAY + "вввввввв" + RED + "вв" + GRAY + "вввв");
            broadcast(GRAY + "вввввввввввввв" + RED + "вв" + GRAY + "вввв");
            broadcast(GRAY + "вввввввввввв" + RED + "вв" + GRAY + "вввввв " + GOLD + "Phase2" + GRAY + " ha empezado");
            broadcast(GRAY + "вввввввввв" + RED + "вв" + GRAY + "вввввввв El nexus ha " + GOLD + "perdido" + GRAY + " la " + GOLD + "invencibilidad");
            broadcast(GRAY + "вввввввв" + RED + "вв" + GRAY + "вввввввввв Los " + GOLD + "bosses" + GRAY + " han " + GOLD + "aparecido");
            broadcast(GRAY + "вввввв" + RED + "вв" + GRAY + "вввввввввввв");
            broadcast(GRAY + "вввв" + RED + "вввввввввввв" + GRAY + "вввв");
            broadcast(GRAY + "вввввввввввввввввввв");
            Annihilation.getInstance().getScoreboardHandler().score.get(ChatColor.DARK_PURPLE + "Fase Actual: ").setScore(PhaseManager.getPhase());
            break;
            case 3:
            broadcast(GRAY + "вввввввввввввввввввв");
            broadcast(GRAY + "вввввв" + RED + "вввввввв" + GRAY + "вввввв");
            broadcast(GRAY + "вввв" + RED + "вв" + GRAY + "вввввввв" + RED + "вв" + GRAY + "вввв");
            broadcast(GRAY + "вввввввввввввв" + RED + "вв" + GRAY + "вввв");
            broadcast(GRAY + "вввввввв" + RED + "вввввв" + GRAY + "вввввв " + GOLD + "Phase3" + GRAY + " ha empezado");
            broadcast(GRAY + "вввввввввввввв" + RED + "вв" + GRAY + "вввв " + AQUA + "Diamantes" + GRAY + " han aparecido en");
            broadcast(GRAY + "вввввввввввввв" + RED + "вв" + GRAY + "вввв el medio del mapa");
            broadcast(GRAY + "вввв" + RED + "вв" + GRAY + "вввввввв" + RED + "вв" + GRAY + "вввв");
            broadcast(GRAY + "вввввв" + RED + "вввввввв" + GRAY + "вввввв");
            broadcast(GRAY + "вввввввввввввввввввв");
            Annihilation.getInstance().getScoreboardHandler().score.get(ChatColor.DARK_PURPLE + "Fase Actual: ").setScore(PhaseManager.getPhase());
            break;
            case 4:
            broadcast(GRAY + "вввввввввввввввввввв");
            broadcast(GRAY + "вввввввввввв" + RED + "вв" + GRAY + "вввввв");
            broadcast(GRAY + "вввввввввв" + RED + "вввв" + GRAY + "вввввв");
            broadcast(GRAY + "вввввввв" + RED + "вв" + GRAY + "вв" + RED + "вв" + GRAY + "вввввв");
            broadcast(GRAY + "вввввв" + RED + "вв" + GRAY + "вввв" + RED + "вв" + GRAY + "вввввв " + GOLD + "Phase4" + GRAY + " ha empezado");
            broadcast(GRAY + "вввв" + RED + "вв" + GRAY + "вввввв" + RED + "вв" + GRAY + "вввввв");
            broadcast(GRAY + "вввв" + RED + "вввввввввввв" + GRAY + "вввв");
            broadcast(GRAY + "вввввввввввв" + RED + "вв" + GRAY + "вввввв");
            broadcast(GRAY + "вввввввввввв" + RED + "вв" + GRAY + "вввввв");
            broadcast(GRAY + "вввввввввввввввввввв");    
            Annihilation.getInstance().getScoreboardHandler().score.get(ChatColor.DARK_PURPLE + "Fase Actual: ").setScore(PhaseManager.getPhase());
            break;
            case 5:
                broadcast(GRAY + "вввввввввввввввввввв");
            broadcast(GRAY + "вввв" + RED + "вввввввввввв" + GRAY + "вввв");
            broadcast(GRAY + "вввв" + RED + "вв" + GRAY + "вввввввввввввв");
            broadcast(GRAY + "вввв" + RED + "вв" + GRAY + "вввввввввввввв");
            broadcast(GRAY + "вввв" + RED + "вввввввввв" + GRAY + "вввввв " + GOLD + "Phase5" + GRAY + " ha empezado");
            broadcast(GRAY + "вввввввввввввв" + RED + "вв" + GRAY + "вввв " + GOLD + "DaГ±o extra" + GRAY + " al picar el" + GOLD + " Nexus");
            broadcast(GRAY + "вввв" + RED + "вв" + GRAY + "вввввввв" + RED + "вв" + GRAY + "вввв cuando lo rompes");
            broadcast(GRAY + "вввв" + RED + "вв" + GRAY + "вввввввв" + RED + "вв" + GRAY + "вввв " + RED + "x2" + GOLD + " daсo extra");
            broadcast(GRAY + "вввввв" + RED + "вввввввв" + GRAY + "вввввв");
            broadcast(GRAY + "вввввввввввввввввввв");;
            Annihilation.getInstance().getScoreboardHandler().score.get(ChatColor.DARK_PURPLE + "Fase Actual: ").setScore(PhaseManager.getPhase());
                        
        }
    }

    public static void winMessage(GameTeam winner) {
            broadcast(GRAY + "вввввввввввввввввввв");
            broadcast(GRAY + "вввввв" + winner.color().toString() + "вввввввввв" + GRAY + "вввв");
            broadcast(GRAY + "вввв" + winner.color().toString() + "вв" + GRAY + "вввввввввввввв");
            broadcast(GRAY + "вввв" + winner.color().toString() + "вв" + GRAY + "вввввввввввввв");
            broadcast(GRAY + "вввв" + winner.color().toString() + "вв" + GRAY + "вввввввввввввв " + GRAY + "El equipo " + winner.coloredName() + GRAY + " ha ganado");
            broadcast(GRAY + "вввв" + winner.color().toString() + "вв" + GRAY + "вввв" + winner.color().toString() + "вввввв" + GRAY + "вввв " + GRAY + "Se reiniciara en " + DARK_PURPLE + "120" + GRAY + " segundos");
            broadcast(GRAY + "вввв" + winner.color().toString() + "вв" + GRAY + "вввввввв" + winner.color().toString() + "вв" + GRAY + "вввв");
            broadcast(GRAY + "вввв" + winner.color().toString() + "вв" + GRAY + "вввввввв" + winner.color().toString() + "вв" + GRAY + "вввв" );
            broadcast(GRAY + "вввввв" + winner.color().toString() + "вввввввв" + GRAY + "вввввв");
            broadcast(GRAY + "вввввввввввввввввввв");
            for(Player p : Bukkit.getOnlinePlayers()) {
            TitleApi.sendFullTitle(p, 40, 40, 2, GRAY + "El equipo " + winner.coloredName() , GRAY + "ha ganado");
            }

    }

    public static void bossDeath(Boss b, Player killer, GameTeam team) {
        broadcast(ChatColor.DARK_PURPLE + "MATARON AL BOSS - " + GRAY + b.getBossName() + GRAY + "  "
                + colorizeName(killer, team));
    }

    public static void bossRespawn(Boss b) {
            broadcast(GRAY + "вввввввввввввввввввв");
            broadcast(GRAY + "вввввв" + RED + "вввввввв" + GRAY + "вввввв");
            broadcast(GRAY + "вввв" + RED + "вв" + GRAY + "вввввввв" + RED + "вв" + GRAY + "вввв");
            broadcast(GRAY + "вввв" + RED + "вв" + GRAY + "вввввввв" + RED + "вв" + GRAY + "вввв");
            broadcast(GRAY + "вввв" + RED + "вв" + GRAY + "вввввв" + RED + "вв" + GRAY + "вввввв" + GOLD + "El Boss" + RED + b.getBossName());
            broadcast(GRAY + "вввв" + RED + "вв" + GRAY + "вввввввв" + RED + "вв" + GRAY + "вввв" + GOLD + "Ha aparecido, a por el!");
            broadcast(GRAY + "вввв" + RED + "вв" + GRAY + "вввввввв" + RED + "вв" + GRAY + "вввв" + GRAY + "Ahora dan cosas chetadas");
            broadcast(GRAY + "вввв" + RED + "вв" + GRAY + "вввввввв" + RED + "вв" + GRAY + "вввв");
            broadcast(GRAY + "вввввв" + RED + "вввввввв" + GRAY + "вввввв");
            broadcast(GRAY + "вввввввввввввввввввв");
    }

    public static String formatDeathMessage(Player victim, Player killer,
            String original) {
        Player p = killer.getPlayer();
        p.getName();
        PlayerMeta meta = PlayerMeta.getMeta(p);
        Kit kit = meta.getKit();
        GameTeam killerTeam = PlayerMeta.getMeta(killer).getTeam();
        String killerColor = killerTeam != null ? killerTeam.color().toString()
                : ChatColor.DARK_PURPLE.toString();
        String killerName = killerColor + killer.getName() + "(" + kit + ")" + ChatColor.GRAY;

        String message = ChatColor.GRAY + formatDeathMessage(victim, original);
        message = message.replace(killer.getName(), killerName);

        return message;
    }

    public static String formatDeathMessage(Player victim, String original) {
        Player p = victim.getPlayer();
        p.getName();
        PlayerMeta meta = PlayerMeta.getMeta(p);
        Kit kit = meta.getKit();
        GameTeam victimTeam = PlayerMeta.getMeta(victim).getTeam();
        String victimColor = victimTeam != null ? victimTeam.color().toString()
                : ChatColor.DARK_PURPLE.toString();
        String victimName = victimColor + victim.getName() + "(" + kit  + ")" + ChatColor.GRAY;

        String message = ChatColor.GRAY + original;
        message = message.replace(victim.getName(), victimName);

        if (message.contains(" пїЅ8пїЅ")) {
            String[] arr = message.split(" пїЅ8пїЅ");
            message = arr[0];
        }

        return message.replace("ha sido asesinado por", "ha muerto por");
    }
    
  
}